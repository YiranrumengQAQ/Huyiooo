<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>QQ 头像高清获取</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC",
                   "Helvetica Neue", Arial, "Microsoft YaHei", sans-serif;
      background: linear-gradient(135deg, #1f2933, #111827);
      color: #e5e7eb;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .container {
      width: 100%;
      max-width: 480px;
      background: rgba(15, 23, 42, 0.92);
      border-radius: 18px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.45);
      padding: 26px 22px 20px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      backdrop-filter: blur(16px);
    }
    .header {
      display: flex;
      align-items: center;
      margin-bottom: 22px;
    }
    .logo {
      width: 40px;
      height: 40px;
      border-radius: 14px;
      background: radial-gradient(circle at 25% 20%, #60a5fa, #1d4ed8);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #eff6ff;
      font-weight: 700;
      font-size: 20px;
      margin-right: 14px;
      box-shadow: 0 10px 30px rgba(37, 99, 235, 0.5);
    }
    .title-block h1 {
      font-size: 18px;
      margin-bottom: 4px;
      color: #f9fafb;
    }
    .title-block p {
      font-size: 12px;
      color: #9ca3af;
    }
    .form-group {
      margin-bottom: 18px;
    }
    .label-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 6px;
    }
    .label-row label {
      font-size: 13px;
      color: #d1d5db;
    }
    .label-row span {
      font-size: 11px;
      color: #6b7280;
    }
    .input-wrap {
      position: relative;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px 82px 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: radial-gradient(circle at 0 0, rgba(148, 163, 184, 0.18), rgba(15, 23, 42, 0.95));
      color: #e5e7eb;
      font-size: 13px;
      outline: none;
      transition: border-color 0.18s ease, box-shadow 0.18s ease, background 0.18s ease;
    }
    input[type="text"]::placeholder {
      color: #6b7280;
    }
    input[type="text"]:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.55);
      background: radial-gradient(circle at 0 0, rgba(129, 140, 248, 0.18), rgba(15, 23, 42, 0.98));
    }
    .btn {
      position: absolute;
      right: 3px;
      top: 3px;
      bottom: 3px;
      width: 76px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      color: #e5e7eb;
      background: linear-gradient(135deg, #2563eb, #4f46e5);
      box-shadow: 0 10px 25px rgba(37, 99, 235, 0.5);
      transition: transform 0.12s ease, box-shadow 0.12s ease, filter 0.12s ease;
    }
    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 32px rgba(37, 99, 235, 0.66);
      filter: brightness(1.05);
    }
    .btn:active {
      transform: translateY(0);
      box-shadow: 0 8px 18px rgba(37, 99, 235, 0.6);
      filter: brightness(0.98);
    }
    .btn:disabled {
      cursor: not-allowed;
      opacity: 0.7;
      box-shadow: none;
      transform: none;
    }
    .status {
      min-height: 18px;
      margin-bottom: 12px;
      font-size: 12px;
      color: #9ca3af;
    }
    .status.error {
      color: #fca5a5;
    }
    .status.success {
      color: #6ee7b7;
    }
    .avatar-card {
      margin-top: 4px;
      padding: 12px;
      border-radius: 16px;
      background: radial-gradient(circle at 0 0, rgba(59, 130, 246, 0.14), rgba(17, 24, 39, 0.95));
      border: 1px solid rgba(55, 65, 81, 0.9);
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .avatar-skeleton,
    .avatar {
      width: 86px;
      height: 86px;
      border-radius: 22px;
      background: radial-gradient(circle at 30% 20%, #4b5563, #0f172a);
      flex-shrink: 0;
      overflow: hidden;
      position: relative;
    }
    .avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .avatar-skeleton::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(120deg,
                  rgba(31, 41, 55, 0.2),
                  rgba(75, 85, 99, 0.55),
                  rgba(31, 41, 55, 0.2));
      transform: translateX(-100%);
      animation: shimmer 1.2s infinite;
    }
    @keyframes shimmer {
      100% {
        transform: translateX(100%);
      }
    }
    .avatar-info {
      flex: 1;
      min-width: 0;
    }
    .avatar-info h2 {
      font-size: 15px;
      color: #f9fafb;
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .tag {
      font-size: 11px;
      padding: 1px 6px;
      border-radius: 999px;
      background: rgba(34, 197, 94, 0.12);
      color: #6ee7b7;
      border: 1px solid rgba(34, 197, 94, 0.28);
    }
    .avatar-info p {
      font-size: 12px;
      color: #9ca3af;
      margin-bottom: 8px;
      word-break: break-all;
    }
    .avatar-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }
    .link-btn {
      font-size: 11px;
      padding: 4px 9px;
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.9);
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      transition: border-color 0.12s ease, background 0.12s ease, color 0.12s ease;
    }
    .link-btn:hover {
      border-color: #60a5fa;
      background: rgba(30, 64, 175, 0.9);
    }
    .footer {
      margin-top: 14px;
      font-size: 11px;
      color: #6b7280;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }
    .footer span {
      white-space: nowrap;
    }
    .footer a {
      color: #9ca3af;
      text-decoration: none;
      border-bottom: 1px dashed rgba(148, 163, 184, 0.7);
    }
    .footer a:hover {
      color: #e5e7eb;
      border-bottom-style: solid;
    }
    @media (max-width: 480px) {
      .container {
        padding: 22px 16px 16px;
      }
      .avatar-card {
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="logo">Q</div>
      <div class="title-block">
        <h1>QQ 头像高清获取</h1>
        <p>输入 QQ 号，一键获取你的高清 QQ 头像</p>
      </div>
    </header>

    <div class="form-group">
      <div class="label-row">
        <label for="qqInput">QQ 号码</label>
        <span>示例：1330903352</span>
      </div>
      <div class="input-wrap">
        <input
          type="text"
          id="qqInput"
          placeholder="请输入 QQ 号，例如：1330903352"
          autocomplete="off"
        />
        <button class="btn" id="queryBtn">获取头像</button>
      </div>
    </div>

    <div id="status" class="status"></div>

    <div id="avatarSection" style="display:none;">
      <div class="avatar-card">
        <div class="avatar-skeleton" id="avatarSkeleton"></div>
        <div class="avatar" id="avatarWrap" style="display:none;">
          <img id="avatarImg" alt="QQ头像" />
        </div>
        <div class="avatar-info">
          <h2>
            <span id="qqText">QQ: -</span>
            <span class="tag">高清头像</span>
          </h2>
          <p id="avatarUrlText"></p>
          <div class="avatar-actions">
            <button class="link-btn" id="openImgBtn">新窗口打开</button>
            <button class="link-btn" id="copyLinkBtn">复制图片链接</button>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <span>接口：api.ahfi.cn /api/qqimg</span>
      <span>方法：GET · 返回：JSON</span>
    </div>
  </div>

  <script>
    const API_BASE = "https://api.ahfi.cn/api/qqimg"; // 接口地址 [web:1]

    const qqInput = document.getElementById("qqInput");
    const queryBtn = document.getElementById("queryBtn");
    const statusEl = document.getElementById("status");
    const avatarSection = document.getElementById("avatarSection");
    const avatarSkeleton = document.getElementById("avatarSkeleton");
    const avatarWrap = document.getElementById("avatarWrap");
    const avatarImg = document.getElementById("avatarImg");
    const qqText = document.getElementById("qqText");
    const avatarUrlText = document.getElementById("avatarUrlText");
    const openImgBtn = document.getElementById("openImgBtn");
    const copyLinkBtn = document.getElementById("copyLinkBtn");

    function setStatus(text, type) {
      statusEl.textContent = text || "";
      statusEl.className = "status" + (type ? " " + type : "");
    }

    function isValidQQ(qq) {
      return /^[1-9][0-9]{4,}$/.test(qq);
    }

    async function fetchAvatar() {
      const qq = qqInput.value.trim();
      if (!qq) {
        setStatus("请输入 QQ 号。", "error");
        return;
      }
      if (!isValidQQ(qq)) {
        setStatus("QQ 号格式不正确，请检查后重试。", "error");
        return;
      }

      const url = API_BASE + "?qq=" + encodeURIComponent(qq);
      queryBtn.disabled = true;
      queryBtn.textContent = "获取中…";
      setStatus("正在获取头像，请稍候…", "success");

      avatarSection.style.display = "none";
      avatarSkeleton.style.display = "block";
      avatarWrap.style.display = "none";

      try {
        const resp = await fetch(url, { method: "GET" });
        if (!resp.ok) {
          throw new Error("接口响应异常：" + resp.status);
        }
        const data = await resp.json();
        const avatarUrl = data.头像 || data.avatar || data.img || data.url;

        if (!avatarUrl) {
          throw new Error("未获取到头像地址，请稍后重试。");
        }

        avatarSection.style.display = "block";
        qqText.textContent = "QQ: " + qq;
        avatarUrlText.textContent = avatarUrl;

        const img = new Image();
        img.src = avatarUrl;
        img.onload = () => {
          avatarImg.src = avatarUrl;
          avatarSkeleton.style.display = "none";
          avatarWrap.style.display = "block";
        };
        img.onerror = () => {
          avatarSkeleton.style.display = "none";
          setStatus("图片加载失败，请稍后重试。", "error");
        };

        setStatus("获取成功，可点击打开或复制链接。", "success");
      } catch (err) {
        setStatus(err.message || "请求失败，请稍后重试。", "error");
      } finally {
        queryBtn.disabled = false;
        queryBtn.textContent = "获取头像";
      }
    }

    queryBtn.addEventListener("click", fetchAvatar);
    qqInput.addEventListener("keyup", (e) => {
      if (e.key === "Enter") {
        fetchAvatar();
      }
    });

    openImgBtn.addEventListener("click", () => {
      const url = avatarImg.src;
      if (url) {
        window.open(url, "_blank");
      }
    });

    copyLinkBtn.addEventListener("click", async () => {
      const url = avatarImg.src;
      if (!url) return;
      try {
        await navigator.clipboard.writeText(url);
        setStatus("图片链接已复制到剪贴板。", "success");
      } catch {
        setStatus("复制失败，请手动复制链接。", "error");
      }
    });
  </script>
</body>
</html>
